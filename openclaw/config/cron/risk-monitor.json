{
  "name": "risk-monitor",
  "schedule": "0 * * * *",
  "timeout_seconds": 300,
  "no_deliver": true,
  "prompt": "BẮT BUỘC thực hiện ĐÚNG các bước sau:\n\nBước 1: Chạy `botcore get_paper_portfolio` và `botcore get_paper_open_trades`\nBước 2: Chạy `botcore get_paper_closed_trades` để xem lệnh đóng gần đây\nBước 3: Chạy `botcore get_market_prices` để xem giá hiện tại\n\nBước 4 — PHÂN TÍCH VÀ HÀNH ĐỘNG:\n\na) Kiểm tra các lệnh vừa đóng (30 phút gần nhất):\n   - Nếu có lệnh hit SL quá nhanh (mở < 30 phút đã chạm SL) → SL có thể quá tight\n   - Nếu 2+ lệnh liên tiếp thua → phân tích nguyên nhân\n   - Nếu phát hiện SL quá tight → NGAY LẬP TỨC chạy `botcore apply_green_adjustment` để tăng stop_loss_percent.\n   ⚠️ NHỚ: stop_loss_percent là PnL%, KHÔNG phải price%. Công thức: price_move = pnl / leverage. Muốn SL 1.5% giá với 10x leverage → set 15 (KHÔNG phải 1.5)\n\nb) Kiểm tra các lệnh đang mở:\n   - So sánh giá hiện tại với entry price và xu hướng thị trường\n   - Nếu thị trường ĐẢO CHIỀU RÕ RÀNG (giá đi ngược hướng trade mạnh, vượt quá mức SL hợp lý) → chạy `botcore close_paper_trade_by_symbol` để close lệnh đó TRƯỚC khi SL trigger. Chỉ close khi THỰC SỰ thấy đảo chiều, KHÔNG close chỉ vì đang lỗ nhẹ.\n   - Nếu lệnh đang lãi tốt nhưng momentum yếu đi → cân nhắc tighten trailing stop\n\nc) Kiểm tra daily loss:\n   - Nếu lỗ ngày > 2% → chạy `botcore apply_green_adjustment` tăng confidence_threshold để engine khó mở lệnh hơn\n   - Nếu engine dừng bất ngờ → cảnh báo KHẨN CẤP\n\nBước 5: Nếu đã thực hiện hành động (close trade hoặc chỉnh setting) → PHẢI chạy `botcore send_telegram_notification` báo cáo hành động đã làm.\nNếu mọi thứ bình thường → không cần gửi.\n\nNGUYÊN TẮC: Engine đã có SL/TP tự động. Bạn CHỈ can thiệp close trade khi phát hiện thị trường đảo chiều đột ngột mà SL thông thường chưa kịp xử lý. Ưu tiên CHỈNH SETTING hơn là close trade.\n\nLUÔN viết bằng tiếng Việt."
}
