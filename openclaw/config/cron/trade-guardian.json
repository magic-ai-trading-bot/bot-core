{
  "name": "trade-guardian",
  "schedule": "0 * * * *",
  "timeout_seconds": 300,
  "no_deliver": true,
  "prompt": "B·∫ÆT BU·ªòC th·ª±c hi·ªán ƒê√öNG c√°c b∆∞·ªõc sau:\n\nB∆∞·ªõc 1: Ch·∫°y `botcore get_paper_portfolio`\nB∆∞·ªõc 2: Ch·∫°y `botcore get_paper_open_trades`\nB∆∞·ªõc 3: Ch·∫°y `botcore get_paper_closed_trades`\nB∆∞·ªõc 4: Ch·∫°y `botcore get_paper_basic_settings`\n\nB∆∞·ªõc 5 ‚Äî KI·ªÇM TRA MARKET REGIME:\n\nT·ª´ k·∫øt qu·∫£ B∆∞·ªõc 4, ƒë·ªçc `short_only_mode` v√† `long_only_mode` hi·ªán t·∫°i.\n\na) Ch·∫°y `botcore get_paper_latest_signals` ‚Äî ki·ªÉm tra c√≥ signal b·ªã block kh√¥ng (signal h∆∞·ªõng b·ªã ch·∫∑n b·ªüi mode)\nb) N·∫øu c√≥ signal KH√îNG ph·∫£i Neutral nh∆∞ng KH√îNG c√≥ trade m·ªõi trong 2h g·∫ßn nh·∫•t ‚Üí ch·∫°y `botcore get_market_condition '{\"symbol\":\"BTCUSDT\"}'`\n   ‚ö†Ô∏è N·∫øu tool l·ªói, d√πng signal data ƒë·ªÉ ∆∞·ªõc l∆∞·ª£ng direction. Neutral signals = direction 0.0 ‚Üí BOTH false.\nc) So s√°nh v·ªõi DECISION MATRIX (xem SOUL.md):\n   - direction ‚â• +0.70 ‚Üí long_only=true, short_only=false\n   - direction ‚â§ -0.70 ‚Üí short_only=true, long_only=false\n   - C√≤n l·∫°i (bao g·ªìm direction=0.0) ‚Üí BOTH false\nd) N·∫øu mode hi·ªán t·∫°i KH√îNG kh·ªõp ‚Üí RESET c·∫£ hai v·ªÅ false b·∫±ng:\n   `botcore update_paper_basic_settings '{\"settings\":{\"risk\":{\"short_only_mode\":false,\"long_only_mode\":false}}}'`\n   Sau ƒë√≥ g·ª≠i c·∫£nh b√°o KH·∫®N qua `botcore send_telegram_notification` v·ªõi n·ªôi dung:\n   \"‚ö†Ô∏è REGIME MISMATCH: direction=X.XX nh∆∞ng mode=short_only/long_only. ƒê√£ RESET v·ªÅ both=false.\"\ne) N·∫øu c·∫£ hai mode ƒë√£ l√† false ‚Üí b√¨nh th∆∞·ªùng, b·ªè qua\n\nB∆∞·ªõc 6 ‚Äî PH√ÇN T√çCH PER-SYMBOL:\n\nT·ª´ closed trades (B∆∞·ªõc 3), t√≠nh WR theo t·ª´ng symbol (l·∫•y 10+ l·ªánh g·∫ßn nh·∫•t m·ªói symbol):\n- N·∫øu symbol n√†o WR < 40% ‚Üí g·ª≠i `botcore send_telegram_notification`:\n  \"‚ö†Ô∏è SYMBOL ALERT: [SYMBOL] WR=[X]% trong [N] l·ªánh g·∫ßn nh·∫•t. C√¢n nh·∫Øc disable ho·∫∑c gi·∫£m position size.\"\n\nB∆∞·ªõc 7 ‚Äî PH√ÇN T√çCH V√Ä H√ÄNH ƒê·ªòNG:\n\na) L·ªánh ƒë√£ ƒë√≥ng (1 gi·ªù g·∫ßn nh·∫•t):\n   - Hit SL qu√° nhanh (< 30 ph√∫t) ‚Üí SL qu√° tight ‚Üí `botcore apply_green_adjustment` tƒÉng stop_loss_percent\n   - 2+ l·ªánh li√™n ti·∫øp thua ‚Üí ph√¢n t√≠ch nguy√™n nh√¢n\n   ‚ö†Ô∏è stop_loss_percent l√† PnL%, KH√îNG ph·∫£i price%. C√¥ng th·ª©c: price_move = pnl / leverage. VD: 10x leverage, mu·ªën SL 1.5% gi√° ‚Üí set 15\n\nb) L·ªánh ƒëang m·ªü:\n   üö´ KH√îNG ƒê∆Ø·ª¢C CLOSE l·ªánh ƒëang m·ªü TR·ª™ KHI th·ªã tr∆∞·ªùng ƒë·∫£o chi·ªÅu ƒê·ªòT NG·ªòT (crash/pump > 5% trong 1h).\n   L·ªó nh·∫π (-0.5%, -1%, -3%) l√† B√åNH TH∆Ø·ªúNG ‚Üí engine c√≥ SL t·ª± ƒë·ªông s·∫Ω x·ª≠ l√Ω.\n   - L·ªánh l√£i > 5% ‚Üí c√¢n nh·∫Øc tighten trailing stop b·∫±ng `botcore apply_green_adjustment`\n\nc) Daily loss > 2% ‚Üí tƒÉng confidence_threshold b·∫±ng `botcore apply_green_adjustment`\n\nd) Win rate < 40% (10 l·ªánh g·∫ßn nh·∫•t) ‚Üí B·∫ÆT BU·ªòC tƒÉng confidence_threshold b·∫±ng `botcore apply_green_adjustment`\n\nB∆∞·ªõc 8: N·∫øu ƒë√£ h√†nh ƒë·ªông ‚Üí PH·∫¢I ch·∫°y `botcore send_telegram_notification` b√°o c√°o. N·∫øu b√¨nh th∆∞·ªùng ‚Üí kh√¥ng g·ª≠i.\n\nNGUY√äN T·∫ÆC V√ÄNG: ∆Øu ti√™n CH·ªàNH SETTING (SL, trailing stop, confidence) h∆°n l√† close trade. KH√îNG BAO GI·ªú close l·ªánh ch·ªâ v√¨ l·ªó nh·∫π. Engine c√≥ SL/TP/Trailing Stop t·ª± ƒë·ªông ‚Äî h√£y tin t∆∞·ªüng engine.\n\nLU√îN vi·∫øt b·∫±ng ti·∫øng Vi·ªát."
}
