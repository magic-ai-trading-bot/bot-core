{
  "name": "self-tuning",
  "schedule": "0 2,8,16 * * *",
  "timeout_seconds": 300,
  "no_deliver": true,
  "prompt": "BẮT BUỘC thực hiện ĐÚNG các bước sau:\n\nBước 1: Chạy `botcore get_tuning_dashboard`\nBước 2: Chạy `botcore get_parameter_bounds`\nBước 3: Chạy `botcore get_adjustment_history`\nBước 4: Chạy `botcore get_paper_closed_trades` để phân tích kết quả trade gần đây\nBước 5: Chạy `botcore get_paper_basic_settings` để xem setting hiện tại\n\nBước 6 — ĐÁNH GIÁ MARKET REGIME:\n\na) Chạy `botcore get_market_condition` cho BTCUSDT\nb) Từ kết quả Bước 5, đọc `short_only_mode` và `long_only_mode` hiện tại\nc) Áp dụng DECISION MATRIX (xem SOUL.md):\n   - direction ≥ +0.70 → long_only=true, short_only=false\n   - direction ≤ -0.70 → short_only=true, long_only=false\n   - Còn lại (bao gồm direction=0.0 NEUTRAL) → BOTH false\nd) Nếu mode hiện tại KHÔNG khớp với direction → sửa bằng:\n   `botcore update_paper_basic_settings '{\"settings\":{\"risk\":{\"short_only_mode\":false,\"long_only_mode\":false}}}'`\n   (hoặc set đúng mode nếu direction ≥ 0.70 hoặc ≤ -0.70)\ne) Ghi nhận regime status để báo cáo ở Bước 9\n\nBước 7 — PHÂN TÍCH VÀ HÀNH ĐỘNG:\n\na) Phân tích hiệu suất từ lần tuning trước:\n   - Win rate tăng hay giảm?\n   - Lệnh thua chủ yếu vì SL quá tight, TP quá xa, hay signal sai?\n   - Có thay đổi nào từ lần trước đang có tác dụng tốt?\n\nb) Quyết định điều chỉnh (tối đa 3 GREEN adjustments):\n   - Nếu SL quá tight (nhiều lệnh hit SL nhanh) → tăng stop_loss_percent\n   - Nếu TP quá xa (lệnh chưa bao giờ chạm TP) → giảm take_profit_percent\n   - Nếu signal chất lượng thấp → tăng confidence_threshold hoặc min_required_indicators\n   - Nếu quá ít signal → giảm min_required_indicators hoặc confidence_threshold\n   - Dùng `botcore apply_green_adjustment` cho mỗi thay đổi\n   ⚠️ QUAN TRỌNG khi chỉnh SL/TP: stop_loss_percent và take_profit_percent là PnL%, KHÔNG phải price%!\n   Công thức: price_move% = pnl% / leverage. Ví dụ: leverage=10x, muốn SL 1.5% giá → set 15% PnL.\n   LUÔN tính price_move sau khi chọn giá trị, đảm bảo price_move nằm trong 0.5-3% cho crypto.\n\nc) Nếu cần thay đổi YELLOW params (leverage, position_size, max_positions) → liệt kê đề xuất cho người dùng\n\nBước 8: Soạn tóm tắt NGẮN (dưới 1000 ký tự) bằng tiếng Việt gồm: setting hiện tại, thay đổi đã áp dụng (nếu có), lý do, đề xuất YELLOW (nếu có), regime status (direction + mode hiện tại).\nBước 9 (QUAN TRỌNG NHẤT): PHẢI chạy `botcore send_telegram_notification` với nội dung tóm tắt.\n\nLUÔN viết bằng tiếng Việt. LUÔN thực hiện bước 9."
}
