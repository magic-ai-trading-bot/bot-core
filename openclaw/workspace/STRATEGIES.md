# STRATEGIES.md - Deep Trading System Knowledge
# Auto-generated by sync-openclaw-knowledge.sh — DO NOT EDIT MANUALLY

## Strategy Signal Generation

### 1. RSI Strategy (Period: 14, Multi-timeframe: 1H + 4H)

| Signal | Condition | Confidence |
|--------|-----------|------------|
| **Strong BUY** | RSI1h ≤ 20.0 AND RSI4h ≤ 25.0 AND RSI recovering (prev < current) | 0.87 |
| **Strong SELL** | RSI1h ≥ 80.0 AND RSI4h ≥ 75.0 AND RSI declining | 0.87 |
| **Moderate BUY** | RSI1h ≤ 25.0 AND RSI4h < 50 AND RSI recovering | 0.73 |
| **Moderate SELL** | RSI1h ≥ 75.0 AND RSI4h > 50 AND RSI declining | 0.73 |
| **Weak BUY** | RSI1h 25.0-50 AND rising AND RSI4h < 50 | 0.51 |
| **Weak SELL** | RSI1h 50-75.0 AND falling AND RSI4h > 50 | 0.51 |

**Win rate**: 65%
**Common failure**: RSI oversold ≠ immediate bounce trong bear trend. Cần confirm trend reversal trước.

### 2. MACD Strategy (Fast: 12, Slow: 26, Signal: 9)

| Signal | Condition | Confidence |
|--------|-----------|------------|
| **Strong BUY** | Bullish crossover + histogram4h > 0.001 + both increasing | 0.89 |
| **Strong SELL** | Bearish crossover + histogram4h < -0.001 + both decreasing | 0.89 |
| **Moderate BUY** | Crossover + 4H histogram increasing, OR both histograms positive + increasing | 0.71 |
| **Moderate SELL** | Crossover + 4H decreasing, OR both negative + decreasing | 0.71 |
| **Weak BUY** | histogram1h increasing AND MACD > Signal AND momentum growing >10% | 0.55 |

**Win rate**: 61%
**Key**: Crossover = prev_MACD ≤ prev_Signal AND current_MACD > current_Signal

### 3. Bollinger Bands Strategy (Period: 20, StdDev: 2.0)

| Signal | Condition | Confidence |
|--------|-----------|------------|
| **Squeeze Breakout BUY** | Squeeze (BB width < 2.00%) + expanding + price > upper + 4H position > 0.5 | 0.87 |
| **Mean Reversion BUY** | BB position ≤ 0.1 + 4H position < 0.3 + NOT expanding | 0.73 |
| **Trend Continuation BUY** | BB position > 0.8 + 4H > 0.6 + expanding | 0.69 |
| **Moderate BUY** | BB position < 0.25 + price > 4H middle band | 0.58 |

**Win rate**: 63%
**BB Position** = (Price - Lower) / (Upper - Lower). 0 = at lower band, 1 = at upper band.

### 4. Volume Strategy (SMA Period: 20, Spike: 2.0x)

| Signal | Condition | Confidence |
|--------|-----------|------------|
| **Strong Volume Surge BUY** | Volume spike (≥2.0x avg) + bullish ratio ≥ 0.7 + price > POC | 0.91 |
| **Accumulation BUY** | High volume (≥1.5x) + bullish ratio ≥ 0.6, OR near POC + ratio ≥ 0.65 | 0.71 |
| **Weak BUY** | Bullish ratio ≥ 0.55 + volume > 1.2x avg | 0.51 |

**Win rate**: 58%
**POC** = Point of Control (price level with highest trading volume in 20 periods)

### 5. Stochastic Oscillator Strategy (K Period: 14, D Period: 3, Multi-timeframe: 1H + 4H)

| Signal | Condition | Confidence |
|--------|-----------|------------|
| **Strong BUY** | Bullish crossover (%K crosses above %D) + K1h ≤ 15.0 + K4h ≤ 15.0 | 0.89 |
| **Extreme BUY** | K1h ≤ 10.0 (extreme oversold) + K4h ≤ 15.0 + K1h > D1h | 0.85 |
| **Strong SELL** | Bearish crossover (%K crosses below %D) + K1h ≥ 85.0 + K4h ≥ 85.0 | 0.89 |
| **Extreme SELL** | K1h ≥ 90.0 (extreme overbought) + K4h ≥ 85.0 + K1h < D1h | 0.85 |
| **Moderate BUY** | Bullish crossover + K1h ≤ 15.0+10 + K4h < 50 | 0.72 |
| **Moderate SELL** | Bearish crossover + K1h ≥ 85.0-10 + K4h > 50 | 0.72 |
| **Weak BUY** | K1h > D1h + K1h < 50 + K4h < 50 + K rising | 0.52 |
| **Weak SELL** | K1h < D1h + K1h > 50 + K4h > 50 + K falling | 0.52 |

**Win rate**: 64%
**Thresholds**: Oversold = 15.0, Overbought = 85.0, Extreme = 10.0/90.0
**Common failure**: Stochastic crossover trong sideways market tạo nhiều false signals. Cần confirm với volume hoặc trend.

---

## Strategy Orchestration

- **5 strategies** run in parallel: RSI, MACD, Bollinger, Volume, Stochastic
- **Minimum agreement**: 4/5 strategies must agree on direction
- **Combination modes**: WeightedAverage (default), Consensus, BestConfidence, Conservative
- **Multi-timeframe**: All strategies analyze both 1H and 4H candles
- **Minimum data**: 50 candles per timeframe required before trading starts
- **Hybrid filter**: Optional AI trend filter for additional validation

---

## Risk Management - 7 Protection Layers

### Layer 1: Position Size Control
- **Limit**: ≤2.0% equity per trade
- **Purpose**: Giới hạn số vốn bỏ vào mỗi trade
- **Calculation**: risk_amount = equity × position_size_pct / 100

### Layer 2: Stop Loss
- **Default**: 5.0% per trade
- **Purpose**: Tự động đóng lệnh khi giá đi ngược quá mức
- **Calculation**: LONG: entry × (1 - 5.0/100), SHORT: entry × (1 + 5.0/100)

### Layer 3: Portfolio Risk Limit
- **Limit**: ≤10.0% total portfolio risk
- **Calculation**: Σ(position_value × stop_loss_distance%) / equity
- **When hit**: Blocks ALL new trades

### Layer 4: Daily Loss Limit
- **Limit**: 3.0% of daily starting equity
- **When hit**: ALL trading stops for rest of day
- **Reset**: Next calendar day (UTC)

### Layer 5: Consecutive Losses Tracking
- **Limit**: 3 consecutive losses max
- **When hit**: Triggers cool-down (Layer 6)
- **Reset**: Counter → 0 on first profitable trade

### Layer 6: Cool-Down Mechanism
- **Trigger**: 3 consecutive losses
- **Duration**: 60 minutes block on ALL new trades
- **Reset**: Automatic after 60 min

### Layer 7: Position Correlation Control
- **Limit**: Max 70% exposure in one direction
- **Calculation**: long_exposure / total_exposure
- **When hit**: Blocks new trades that increase concentration

**Execution order**: Daily Loss → Cool-Down → Correlation → Portfolio Risk → Position Size + Stop Loss → Execute

---

## Execution Simulation

| Feature | Default | Detail |
|---------|---------|--------|
| **Slippage** | ON (0.05% max) | BUY: price × (1 + slippage%), SELL: price × (1 - slippage%) |
| **Execution Delay** | 100ms | Simulates network latency, re-fetches price after delay |
| **Market Impact** | OFF | impact = (order_value / typical_volume) × factor, capped 1% |
| **Partial Fills** | OFF | 10% chance, fills 30-90% of order |

---

## Common Loss Patterns & Solutions

| Pattern | Symptoms | Solution |
|---------|----------|----------|
| **False breakout** | Entry on Bollinger squeeze breakout, reverses | Wait for volume confirmation |
| **Counter-trend entry** | RSI oversold BUY in strong downtrend | Add EMA 50/200 trend filter |
| **Overtrading** | >20 trades/day, many small losses | Increase confidence threshold |
| **Late entry** | Enter after majority of move | Check MACD histogram declining = late |
| **Stop loss too tight** | Many -5.0% losses that recover | Widen based on ATR (1.5-2x) |
| **Correlated positions** | Same-direction trades lose together | Check correlation limit |
| **Cool-down panic** | Force trades after cool-down | Extend cool-down, reduce size |
| **Volume dry-up** | Low volume, high slippage | Skip signals volume < 0.8x avg |
| **Stochastic whipsaw** | Crossovers in sideways market | Combine with volume/trend filter |

---

## Key Configuration Defaults

```
Risk (7 layers):
  position_size_pct: 2.0%
  stop_loss_pct: 5.0%
  max_portfolio_risk: 10.0%
  daily_loss_limit: 3.0%
  max_consecutive_losses: 3
  cool_down_minutes: 60
  correlation_limit: 70%

Strategy:
  active_strategies: 5 (RSI, MACD, Bollinger, Volume, Stochastic)
  min_strategies_agreement: 4/5
  min_confidence: 0.5
  signal_interval: 5 min

Execution:
  slippage: ON (0.05% max)
  delay: 100ms
  market_impact: OFF
  partial_fills: OFF
```
